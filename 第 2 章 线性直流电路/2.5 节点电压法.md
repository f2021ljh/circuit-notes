## 节点电压
在电路中任意选定一个节点作为 **参考节点**，假设其电位为零，电路中其他各节点到参考节点的电压称为 **节点电压**。
由于电压（电位降）是相对的且是确定的，设定的节点电压（电位）必然自动满足 KVL。
## 节点电压法
### 一般方法
由于节点电压自动满足 KVL，故在支路电流法的基础上，只需要选定 $n-1$ 个节点，列写 KCL 方程即可。这称为 **节点电压法**。
与回路电流法类似，由各支路电压与电阻（电导）可知各支路电流，进而可列写各节点的 KCL 方程。下面设电流流出为正、流入为负，对节点 $k$ 列写 KCL 方程。
- 设一个相邻节点为 $j$，$k$ 到 $j$ 的支路上只有电阻（电导），则从 $k$ 流出的电流为 $G_{kj}U_{kj}=G_{kj}(U_k-U_j)=G_{kj}U_k-G_{kj}U_j$，其中 $G_{kj}$ 为支路上串联电阻之和的倒数。
- 如果支路上有电压源 $U_{\mathrm S}$（正极性端在节点 $k$ 一侧），则支路流出电流为 $G_{kj}(U_{kj}-U_{\mathrm S})=G_{kj}U_k-G_{kj}U_j-G_{kj}U_{\mathrm S}$。
- 如果支路上有电流源，流入节点 $k$ 的电流为 $I_{\mathrm S}$，则流出电流一定为 $-I_{\mathrm S}$，与支路上电压源或电阻无关。
综上，将与节点 $k$ 邻接的各个支路的 KCL 方程相加，整理可得最终的方程：$$G_{kk}U_k+\sum_jG_{kj}U_j=\sum I _{\mathrm{S}}+\sum G_{kj}U _{\mathrm{S}},$$其中：
- $G_{kk}=\sum_jG_{kj}$ 为节点 $k$ 的 **自导**，即与节点相连的所有支路（无电流源）上电导之和；
- $G_{kj}$ 为节点 $k$ 与节点 $j$ 之间的 **互导**，即节点 $k,j$ 之间支路（无电流源）上电导之和的 *负值*；
- $\sum I _{\mathrm{S}}$ 为从电流源 *流入* 节点 $k$ 的电流之和；
- $\sum G_{kj}U _{\mathrm{S}}$ 为与节点 $k$ 相连的电压源所在支路的电导，乘以该电压源提供的电压，所得乘积之和，正极性端在节点 $k$ 一侧则为正电压，否则为负电压。
### 注意事项
- 对于含源支路：
	- 对于含电压源支路，需要在等式右侧加上 $GU$，其中 $G$ 为支路电导之和，$U$ 为电压（正极性端与节点同侧则为正，否则为负）；
	- 对于含电流源支路，等式左侧无需再考虑该支路互导，等式右侧加上从电流源流入节点的电流。
- 对于含受控源电路：与回路电流法类似，先将其当做独立源，再将其控制量用节点电压表示，并进行代入消元。（此时互导矩阵不再对称。）
- 如果出现两节点间有 **纯电压源支路**，则支路电导为无穷大，故不能直接列方程。一般可以：
	- 增设电压源支路的电流，并额外列出电压源两端节点电压受电压源电压约束的方程，这样方程数仍然足够，理论上可以求解；
	- 巧设参考节点，将电压源支路一端的节点设为参考节点，这样另一端的节点电压就确定了；
	- 设 **超节点**：将电压源及其两端节点所在的闭合面看做一个超节点，将这两个节点的方程替换为超节点的方程，并同时列出电压源两端节点电压受电压源电压约束的方程。
## 改进节点电压法
如果电路中存在某种非二端电阻元件（如 **纯电压源支路**），则支路电导为无穷大，故不能直接用支路电导与电压之积来表示。
为解决这类问题，需对节点电压法进行修正，建立所谓的 **改进节点电压法**。
具体地，增设非二端电阻元件的电流，以 $n-1$ 个节点电压和非二端电阻元件的电流为待求量，先列写 $n-1$ 个节点的 KCL 方程，再列写非二端电阻元件的约束方程，联立求解。
下面通过一道例题具体说明。
> [!question] 例题：改进节点电压法
> 列出下图所示电路对应不同参考点的节点电压方程，并计算 $\pu{25\Omega}$ 电阻消耗的功率。
> ![[第 2 章 线性直流电路/images/2.5/modified-node-voltage-example.png]]

(a) 如图，以节点 ① 为参考节点，注意支路 ③④ 为纯电压源支路，电阻为零，不能正常列节点电压方程。考虑一般节点电压法的本质是 KCL 方程，我们将纯电压源支路的电流设为 $I$，列入 KCL 方程中（类似纯电流源支路）。故有： $$\begin{aligned}
	&\left(\frac{1}{\pu{25\Omega}}+\frac{1}{\pu{20\Omega}}+\frac{1}{\pu{40\Omega}}\right)U _{\mathrm{n2}}-\frac{1}{\pu{20\Omega}}U _{\mathrm{n3}}-\frac{1}{\pu{40\Omega}}U _{\mathrm{n4}}=0,\\
	&-\frac{1}{\pu{20\Omega}}U _{\mathrm{n2}}+\left(\frac{1}{\pu{10\Omega}}+\frac{1}{\pu{20\Omega}}\right)U _{\mathrm{n3}}=\frac{\pu{20V}}{\pu{10\Omega}}+I,\\
    &-\frac{1}{\pu{40\Omega}}U _{\mathrm{n2}}+\left(\frac{1}{\pu{50\Omega}}+\frac{1}{\pu{40\Omega}}\right)U _{\mathrm{n4}}=-\frac{\pu{10V}}{\pu{50\Omega}}-I.
\end{aligned}$$以上三个方程无法解出四个未知量，还有一个电压源特性方程：$$U _{\mathrm{n3}}-U _{\mathrm{n4}}=\pu{30V}.$$由此可解得所有节点电压。
(b) 如图，以节点④为参考节点，那么 $U _{\mathrm{n3}}=\pu{30V}$，其他节点正常列写即可：$$\begin{aligned}
	&\left(\frac{1}{\pu{50\Omega}}+\frac{1}{\pu{25\Omega}}+\frac{1}{\pu{10\Omega}}\right)U _{\mathrm{n1}}-\frac{1}{\pu{25\Omega}}U _{\mathrm{n2}}-\frac{1}{\pu{10\Omega}}U _{\mathrm{n3}}=\frac{\pu{10V}}{\pu{50\Omega}}-\frac{\pu{20V}}{\pu{10\Omega}},\\
	&-\frac{1}{\pu{25\Omega}}U _{\mathrm{n1}}+\left(\frac{1}{\pu{25\Omega}}+\frac{1}{\pu{20\Omega}}+\frac{1}{\pu{40\Omega}}\right)U _{\mathrm{n2}}-\frac{1}{\pu{20\Omega}}U _{\mathrm{n3}}=0.
\end{aligned}$$注意到此时不需要求出 $I$，因此只需列出两个方程，即可解得两个未知变量 $U _{\mathrm{n1}},U _{\mathrm{n2}}$。
功率为 $P=\dfrac{U^2}{\pu{25\Omega}}=\dfrac{(U _{\mathrm{n1}}-U _{\mathrm{n2}})^2}{\pu{25\Omega}}$。

综上，对于含纯电压源支路的电路，最好将其两端点之一设为参考节点。
如果要用到该支路上的电流 $I$，就将该支路 **看成是电流源** $I$ 列方程，称为改进节点电压法。
## 超节点法
KCL 对一个闭合区域内的节点集合也成立，故可以